---
title: "Income inequality"
author: "Lyubomir N. Kolev"
date: "2025-08-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Income Inequality - Tidy Tuesday Week 31

This week we're exploring Income Inequality Before and After Taxes, as processed and visualized by Joe Hasell at Our World in Data: ["Income inequality before and after taxes: how much do countries redistribute income?"](https://ourworldindata.org/income-inequality-before-and-after-taxes)

All data was processed by \[Our World in Data\]\]([https://ourworldindata.org](https://ourworldindata.org/)), using these sources:

-   [Luxembourg Income Study (2025)](https://www.lisdatacenter.org/our-data/lis-database/)

-   [OECD (2024)](https://www.oecd.org/en/data/datasets/income-and-wealth-distribution-database.html)

-   [HYDE (2023)](https://public.yoda.uu.nl/geo/UU01/AEZZIT.html)

-   [Gapminder - Population v7 (2022)](https://www.gapminder.org/data/documentation/gd003/)

-   [UN, World Population Prospects (2024)](https://population.un.org/wpp/downloads?folder=Standard%20Projections&group=Most%20used)

-   [Gapminder - Systema Globalis (2022)](https://github.com/open-numbers/ddf--gapminder--systema_globalis)

> The Gini coefficient measures inequality on a scale from 0 to 1. Higher values indicate higher inequality. Inequality is measured here in terms of income before and after taxes and benefits.

-   Which countries have the highest Gini coefficient before taxes?

-   Which countries have the highest Gini coefficient after taxes?

-   Which countries have the highest shifts in Gini coefficient?

-   Which countries have the lowest shifts in Gini coefficient?

-   Which countries have had the highest changes in redistribution in the available data?

Thank you to [Jon Harmon, Data Science Learning Community](https://github.com/jonthegeek) for curating this week's dataset.

## **The Data**

```{r libraries}
library(tidyverse)
library(readxl)
library(tmap)
library(sf)
library(rnaturalearth)
```

```{r}
data_dictionary <-
  read_csv("Data Dictionary - income inequality.csv")
```

```{r import_data}
income_inequality_processed <- 
  read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-08-05/income_inequality_processed.csv'
  )

income_inequality_raw <- 
  read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-08-05/income_inequality_raw.csv'
  )
```

```{r}
EU_countries <-
  read_excel("Country List by Continent.xlsx", sheet = 1)
```

```{r}
NA_countries <-
  read_excel("Country List by Continent.xlsx", sheet = 2)
```

```{r}
Asia_countries <-
  read_excel("Country List by Continent.xlsx", sheet = 3)
```

```{r}
Africa_countries <-
  read_excel("Country List by Continent.xlsx", sheet = 4)
```

```{r}
SA_countries <-
  read_excel("Country List by Continent.xlsx", sheet = 5)
```

```{r}
Oceania_countries <-
  read_excel("Country List by Continent.xlsx", sheet = 6)
```

```{r join_data}
all_data <-
  income_inequality_raw |> 
  left_join(
    income_inequality_processed, by = c("Entity", "Code", "Year")
  )
```

```{r disposable}
ten_worst_disposable <-
  all_data |> 
  filter(
    !is.na(gini_disposable__age_total)
  ) |> 
  slice_max(gini_disposable__age_total, n = 10)

ten_best_disposable <-
  all_data |> 
  filter(
    !is.na(gini_disposable__age_total)
  ) |> 
  slice_min(gini_disposable__age_total, n = 10)
```

```{r market}
ten_worst_market <-
  all_data |> 
  filter(
    !is.na(gini_market__age_total)
  ) |> 
  slice_max(gini_market__age_total, n = 10)

ten_best_market <-
  all_data |> 
  filter(
    !is.na(gini_market__age_total)
  ) |> 
  slice_min(gini_market__age_total, n = 10)
```

```{r mi}
ten_worst_mi <- # pre-tax
  all_data |> 
  filter(
    !is.na(gini_mi_eq)
  ) |> 
  slice_max(gini_mi_eq, n = 10)

ten_best_mi <- # pre-tax
  all_data |> 
  filter(
    !is.na(gini_mi_eq)
  ) |> 
  slice_min(gini_mi_eq, n = 10)
```

```{r dhi}
ten_worst_dhi <- # post-tax
  all_data |> 
  filter(
    !is.na(gini_dhi_eq)
  ) |> 
  slice_max(gini_dhi_eq, n = 10)

ten_best_dhi <- # post-tax
  all_data |> 
  filter(
    !is.na(gini_dhi_eq)
  ) |> 
  slice_min(gini_dhi_eq, n = 10)
```

```{r}
europe <-
    ne_countries(scale = "medium", continent = "Europe", returnclass = "sf")

tm_shape(europe) +
    tm_fill()
```